<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>dont reinvent велосипед - tips</title><link href="https://dontreinventbicycle.com/" rel="alternate"></link><link href="https://dontreinventbicycle.com/feeds/tips.atom.xml" rel="self"></link><id>https://dontreinventbicycle.com/</id><updated>2020-11-04T00:00:00+08:00</updated><entry><title>how to migrate your GitHub repository to Codeberg</title><link href="https://dontreinventbicycle.com/github-to-codeberg-howto.html" rel="alternate"></link><published>2020-11-04T00:00:00+08:00</published><updated>2020-11-04T00:00:00+08:00</updated><author><name>Dafne Kiyui</name></author><id>tag:dontreinventbicycle.com,2020-11-04:/github-to-codeberg-howto.html</id><summary type="html">&lt;p&gt;The easiest way to migrate repositories is to simply change where your local repository remote points to. In a locally cloned repository, assert that you should have a git remote (usually named &lt;code&gt;origin&lt;/code&gt;) by running &lt;code&gt;git remote -v&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;origin  git@github.com:username/repository.git (fetch)&lt;/span&gt;
&lt;span class="err"&gt;origin  git@github.com …&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;The easiest way to migrate repositories is to simply change where your local repository remote points to. In a locally cloned repository, assert that you should have a git remote (usually named &lt;code&gt;origin&lt;/code&gt;) by running &lt;code&gt;git remote -v&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;origin  git@github.com:username/repository.git (fetch)&lt;/span&gt;
&lt;span class="err"&gt;origin  git@github.com:username/repository.git (push)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;On your &lt;a href="https://codeberg.org/"&gt;Codeberg&lt;/a&gt; dashboard, create a new repository (&lt;a href="https://docs.codeberg.org/getting-started/first-repository/"&gt;guide&lt;/a&gt;) and copy its upstream URL. You can then simply update the remote by running,&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;git remote set-url origin git@codeberg.org:username/repository.git
git push -u origin master &lt;span class="c1"&gt;# Or whatever other branch&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;h3&gt;maintaining a mirror&lt;/h3&gt;
&lt;p&gt;If you're not interested in fully migrating your repository over to Codeberg and would rather maintain a mirror, you can simply set up an additional remote as so,&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# You can name the remote something other than codeberg&lt;/span&gt;
git remote add codeberg git@codeberg.org:username/repository.git
git push codeberg master &lt;span class="c1"&gt;# Or whatever other branch&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This of course means that in addition to just running &lt;code class="highlight"&gt;git push&lt;/code&gt; to push to a branch's regular upstream, you'd have to run &lt;code class="highlight"&gt;git push codeberg&lt;/code&gt; as well.&lt;/p&gt;
&lt;h3&gt;using the Gitea migration feature&lt;/h3&gt;
&lt;p&gt;Codeberg also offers a &lt;a href="https://docs.gitea.io/en-us/migrations-interfaces/"&gt;migration interface&lt;/a&gt; that can import Issues, Pull Requests, Releases, and more (&lt;a href="https://codeberg.org/kiyui/gnome-shell-night-light-slider-extension/issues/76"&gt;an example imported issue&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;To do this, you'll want to create a new &lt;a href="https://github.com/settings/tokens"&gt;personal access token&lt;/a&gt; by visiting &lt;a href="https://github.com/settings/tokens/new"&gt;this link&lt;/a&gt;. Under the &lt;strong&gt;“select scopes”&lt;/strong&gt; header, you'll want to make sure you check the &lt;strong&gt;“repo”&lt;/strong&gt; scope, giving it access to your repositories. You can read more on how to do this under the &lt;a href="https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/creating-a-personal-access-token"&gt;official GitHub documentation&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Next, you'll want to visit the Codeberg &lt;a href="https://codeberg.org/repo/migrate"&gt;“New Migration”&lt;/a&gt; page. This can also be done by clicking the “New Migration” option under the same menu on the top right where you'd regularly create a new repository.&lt;/p&gt;
&lt;p&gt;&lt;img alt="The Codeberg new repository dropdown, with “New migration” listed as one of the options" src="https://dontreinventbicycle.com/images/github-to-codeberg-howto/codeberg-new-repo.png"&gt;&lt;/p&gt;
&lt;p&gt;On the &lt;a href="https://codeberg.org/repo/migrate"&gt;“New Migration”&lt;/a&gt; page, you should be greeted with a form split into 2 sections. Under the first section,&lt;/p&gt;
&lt;p&gt;You'll want to populate the “Migrate/Clone From URL” input with your &lt;strong&gt;GitHub HTTPS clone URL&lt;/strong&gt;. This is important such that other items would be made available under the “Migration Items” section.&lt;/p&gt;
&lt;p&gt;Under “Clone Authorization”, you'll want to have your username filled as usual but have the &lt;strong&gt;GitHub access token set as the password&lt;/strong&gt;. ⚠️  Do not use your actual password here!&lt;/p&gt;
&lt;p&gt;The rest, such as the “Repository Name”, “Visibility”, “Migration Items”, and “Description” can be filled to your discretion. &lt;/p&gt;
&lt;p&gt;&lt;img alt="The Codeberg migration interface, with “https://github.com/username/repository.git” as the “Migrate/Clone From URL”, the username &amp;amp; password filled under “Clone Authorization”, and in a separate section all the import details such as the “Repository Name”, “Visibility”, “Migration Items” (consisting of checkboxes for “Wiki“, “Milestones“, “Labels“, “Issues“, “Pull Requests“, and “Releases“), and the “Description”" src="https://dontreinventbicycle.com/images/github-to-codeberg-howto/codeberg-migration.png"&gt;&lt;/p&gt;
&lt;p&gt;Clicking the “Migrate Repository” should redirect you to a loading screen, and finally the brand new repository. Et voilà!&lt;/p&gt;</content><category term="tips"></category><category term="hosting"></category><category term="git"></category></entry><entry><title>"debounce" in gjs</title><link href="https://dontreinventbicycle.com/gjs-debounce.html" rel="alternate"></link><published>2020-09-16T00:00:00+08:00</published><updated>2020-09-16T00:00:00+08:00</updated><author><name>Dafne Kiyui</name></author><id>tag:dontreinventbicycle.com,2020-09-16:/gjs-debounce.html</id><summary type="html">&lt;p&gt;The following code is licensed under the &lt;a href="https://www.gnu.org/licenses/lgpl-3.0.txt"&gt;GNU Lesser General Public License v3.0 or later&lt;/a&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="cm"&gt;/* exported debounce */&lt;/span&gt;
&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;GLib&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;imports&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;gi&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * Copyright 2020 Dafne Kiyui&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; * This program is free software: you can redistribute it and/or modify&lt;/span&gt;
&lt;span class="cm"&gt; * it under the terms of the GNU Lesser General Public License as …&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;The following code is licensed under the &lt;a href="https://www.gnu.org/licenses/lgpl-3.0.txt"&gt;GNU Lesser General Public License v3.0 or later&lt;/a&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="cm"&gt;/* exported debounce */&lt;/span&gt;
&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;GLib&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;imports&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;gi&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * Copyright 2020 Dafne Kiyui&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; * This program is free software: you can redistribute it and/or modify&lt;/span&gt;
&lt;span class="cm"&gt; * it under the terms of the GNU Lesser General Public License as published by&lt;/span&gt;
&lt;span class="cm"&gt; * the Free Software Foundation, either version 3 of the License, or&lt;/span&gt;
&lt;span class="cm"&gt; * (at your option) any later version.&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; * This program is distributed in the hope that it will be useful,&lt;/span&gt;
&lt;span class="cm"&gt; * but WITHOUT ANY WARRANTY; without even the implied warranty of&lt;/span&gt;
&lt;span class="cm"&gt; * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&lt;/span&gt;
&lt;span class="cm"&gt; * GNU Lesser General Public License for more details.&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; * You should have received a copy of the GNU Lesser General Public License&lt;/span&gt;
&lt;span class="cm"&gt; * along with this program.  If not, see &amp;lt;https://www.gnu.org/licenses/&amp;gt;.&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;

&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * Decorate a function in a debounce wrapper&lt;/span&gt;
&lt;span class="cm"&gt; * @param {Function} func - The function to decorate&lt;/span&gt;
&lt;span class="cm"&gt; * @param {number} wait - Duration to wait in milliseconds&lt;/span&gt;
&lt;span class="cm"&gt; * @param {Object} options&lt;/span&gt;
&lt;span class="cm"&gt; * @param {number} options.priority - GLib.PRIORITY_{LOW,HIGH,..etc}&lt;/span&gt;
&lt;span class="cm"&gt; * @returns {Function} - A debounced variant of `func`&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;debounce&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;func&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;wait&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;options&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;priority&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="nx"&gt;GLib&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;PRIORITY_DEFAULT&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;let&lt;/span&gt; &lt;span class="nx"&gt;sourceId&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="p"&gt;(...&lt;/span&gt;&lt;span class="nx"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;debouncedFunc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;sourceId&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;null&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="nx"&gt;func&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;args&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="p"&gt;};&lt;/span&gt;

        &lt;span class="c1"&gt;// It is a programmer error to attempt to remove a non-existent source&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;sourceId&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="nx"&gt;GLib&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Source&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;remove&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;sourceId&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
        &lt;span class="nx"&gt;sourceId&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;GLib&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;timeout_add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;options&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;priority&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;wait&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;debouncedFunc&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="LGPL logo" src="https://dontreinventbicycle.com/images/lgplv3.png"&gt;&lt;/p&gt;
&lt;p&gt;A typical &lt;code&gt;debounce&lt;/code&gt; function in JS decorates a callback function in a &lt;code&gt;setTimeout&lt;/code&gt; block, running &lt;code&gt;clearTimeout&lt;/code&gt; and re-decorating the callback function as the decorated function is called over time. In GJS however, neither &lt;code&gt;setTimeout&lt;/code&gt; nor &lt;code&gt;clearTimeout&lt;/code&gt; are defined. Instead, &lt;code&gt;GLib.timeout_add&lt;/code&gt; is the GJS equivalent of &lt;code&gt;setTimeout&lt;/code&gt; and &lt;code&gt;setInterval&lt;/code&gt; in JavaScript. See the &lt;a href="/gjs-set-timeout-interval.html"&gt;setTimeout and setInterval in gjs&lt;/a&gt; article for more information.&lt;/p&gt;</content><category term="tips"></category><category term="gnome-shell"></category><category term="gjs"></category><category term="gtk"></category></entry><entry><title>setTimeout and setInterval in gjs</title><link href="https://dontreinventbicycle.com/gjs-set-timeout-interval.html" rel="alternate"></link><published>2020-09-16T00:00:00+08:00</published><updated>2020-09-16T00:00:00+08:00</updated><author><name>Dafne Kiyui</name></author><id>tag:dontreinventbicycle.com,2020-09-16:/gjs-set-timeout-interval.html</id><summary type="html">&lt;p&gt;The &lt;a href="https://gjs-docs.gnome.org/glib20~2.64.1/glib.timeout_add"&gt;GLib.timeout_add&lt;/a&gt; function is the GJS equivalent to both &lt;code&gt;setTimeout&lt;/code&gt; and &lt;code&gt;setInterval&lt;/code&gt;. It calls a given function repeatedly (such as &lt;code&gt;func&lt;/code&gt;) at given intervals until it returns a falsy value. It returns a &lt;a href="https://gjs-docs.gnome.org/glib20~2.64.1/glib.source"&gt;GLib Source&lt;/a&gt; id, which just like &lt;code&gt;clearTimeout&lt;/code&gt; or &lt;code&gt;clearInterval&lt;/code&gt; can be removed with the static &lt;a href="https://gjs-docs.gnome.org/glib20~2.64.1/glib.source#function-remove"&gt;GLib …&lt;/a&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;The &lt;a href="https://gjs-docs.gnome.org/glib20~2.64.1/glib.timeout_add"&gt;GLib.timeout_add&lt;/a&gt; function is the GJS equivalent to both &lt;code&gt;setTimeout&lt;/code&gt; and &lt;code&gt;setInterval&lt;/code&gt;. It calls a given function repeatedly (such as &lt;code&gt;func&lt;/code&gt;) at given intervals until it returns a falsy value. It returns a &lt;a href="https://gjs-docs.gnome.org/glib20~2.64.1/glib.source"&gt;GLib Source&lt;/a&gt; id, which just like &lt;code&gt;clearTimeout&lt;/code&gt; or &lt;code&gt;clearInterval&lt;/code&gt; can be removed with the static &lt;a href="https://gjs-docs.gnome.org/glib20~2.64.1/glib.source#function-remove"&gt;GLib.Source.remove&lt;/a&gt; function.&lt;/p&gt;
&lt;p&gt;The following code is licensed under the &lt;a href="https://www.gnu.org/licenses/lgpl-3.0.txt"&gt;GNU Lesser General Public License v3.0 or later&lt;/a&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="cm"&gt;/* exported clearTimeout clearInterval setTimeout setInterval */&lt;/span&gt;

&lt;span class="cm"&gt;/**&lt;/span&gt;
&lt;span class="cm"&gt; * Copyright 2020 Dafne Kiyui&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; * This program is free software: you can redistribute it and/or modify&lt;/span&gt;
&lt;span class="cm"&gt; * it under the terms of the GNU Lesser General Public License as published by&lt;/span&gt;
&lt;span class="cm"&gt; * the Free Software Foundation, either version 3 of the License, or&lt;/span&gt;
&lt;span class="cm"&gt; * (at your option) any later version.&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; * This program is distributed in the hope that it will be useful,&lt;/span&gt;
&lt;span class="cm"&gt; * but WITHOUT ANY WARRANTY; without even the implied warranty of&lt;/span&gt;
&lt;span class="cm"&gt; * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the&lt;/span&gt;
&lt;span class="cm"&gt; * GNU Lesser General Public License for more details.&lt;/span&gt;
&lt;span class="cm"&gt; *&lt;/span&gt;
&lt;span class="cm"&gt; * You should have received a copy of the GNU Lesser General Public License&lt;/span&gt;
&lt;span class="cm"&gt; * along with this program.  If not, see &amp;lt;https://www.gnu.org/licenses/&amp;gt;.&lt;/span&gt;
&lt;span class="cm"&gt; */&lt;/span&gt;
&lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="nx"&gt;GLib&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;imports&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;gi&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;clearTimeout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;clearInterval&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="nx"&gt;clearTimeout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;clearInterval&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;GLib&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Source&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;remove&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;setTimeout&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;func&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;delay&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;wrappedFunc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;func&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;args&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
    &lt;span class="p"&gt;};&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;GLib&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;timeout_add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;GLib&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;PRIORITY_DEFAULT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;delay&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;wrappedFunc&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;setInterval&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;func&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;delay&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;...&lt;/span&gt;&lt;span class="nx"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kr"&gt;const&lt;/span&gt; &lt;span class="nx"&gt;wrappedFunc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;=&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;func&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;apply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;this&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;||&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;};&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nx"&gt;GLib&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;timeout_add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;GLib&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;PRIORITY_DEFAULT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;delay&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nx"&gt;wrappedFunc&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="LGPL logo" src="https://dontreinventbicycle.com/images/lgplv3.png"&gt;&lt;/p&gt;
&lt;p&gt;For the sake of trivia, according to &lt;a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setInterval"&gt;MDN&lt;/a&gt;, both &lt;code&gt;setTimeout()&lt;/code&gt; and &lt;code&gt;setInterval()&lt;/code&gt; share the same pool of IDs. As such, both &lt;code&gt;clearTimeout()&lt;/code&gt; and &lt;code&gt;clearInterval()&lt;/code&gt; can be used interchangeably. This makes the above code pretty compatible and standards compliant 😉&lt;/p&gt;</content><category term="tips"></category><category term="gnome-shell"></category><category term="gjs"></category><category term="gtk"></category><category term="javascript"></category></entry><entry><title>batch renaming numbered files</title><link href="https://dontreinventbicycle.com/batch-renames.html" rel="alternate"></link><published>2020-08-16T00:00:00+08:00</published><updated>2020-08-16T00:00:00+08:00</updated><author><name>Dafne Kiyui</name></author><id>tag:dontreinventbicycle.com,2020-08-16:/batch-renames.html</id><summary type="html">&lt;p&gt;The year is 2009 and your minimalist CD ripper, let's say &lt;code&gt;goobox&lt;/code&gt; hasn't multi-CD support. The ripped content of both CD 1 &amp;amp; 2 are numbered incrementally from &lt;code&gt;01&lt;/code&gt; onwards, which isn't a problem if you organised your library by CD 1/2/etc, but you're rather flatten the directory because …&lt;/p&gt;</summary><content type="html">&lt;p&gt;The year is 2009 and your minimalist CD ripper, let's say &lt;code&gt;goobox&lt;/code&gt; hasn't multi-CD support. The ripped content of both CD 1 &amp;amp; 2 are numbered incrementally from &lt;code&gt;01&lt;/code&gt; onwards, which isn't a problem if you organised your library by CD 1/2/etc, but you're rather flatten the directory because you used &lt;code&gt;mongodb&lt;/code&gt; once.&lt;/p&gt;
&lt;p&gt;The following is a shorthand for incrementing the numbers on disc 2 by &lt;code&gt;12&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;perl-rename -n &lt;span class="s1"&gt;&amp;#39;s/(\d+)/($1 + 12)/e&amp;#39;&lt;/span&gt; *.ogg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;The &lt;code&gt;-n&lt;/code&gt; here makes it a dry run, which outputs the following for you to confirm:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;01. Slave to Your Mind.ogg -&amp;gt; 13. Slave to Your Mind.ogg&lt;/span&gt;
&lt;span class="err"&gt;02. Shortcut to Salvation.ogg -&amp;gt; 14. Shortcut to Salvation.ogg&lt;/span&gt;
&lt;span class="err"&gt;03. The Man in the Iron Cage.ogg -&amp;gt; 15. The Man in the Iron Cage.ogg&lt;/span&gt;
&lt;span class="err"&gt;04. The Road Called Home.ogg -&amp;gt; 16. The Road Called Home.ogg&lt;/span&gt;
&lt;span class="err"&gt;05. Sloth.ogg -&amp;gt; 17. Sloth.ogg&lt;/span&gt;
&lt;span class="err"&gt;06. Freedom Song.ogg -&amp;gt; 18. Freedom Song.ogg&lt;/span&gt;
&lt;span class="err"&gt;07. I m Running.ogg -&amp;gt; 19. I m Running.ogg&lt;/span&gt;
&lt;span class="err"&gt;08. The Mask.ogg -&amp;gt; 20. The Mask.ogg&lt;/span&gt;
&lt;span class="err"&gt;09. Confrontation.ogg -&amp;gt; 21. Confrontation.ogg&lt;/span&gt;
&lt;span class="err"&gt;10. The Battle.ogg -&amp;gt; 22. The Battle.ogg&lt;/span&gt;
&lt;span class="err"&gt;11. Broken Sky Long Day (Reprise).ogg -&amp;gt; 23. Broken Sky Long Day (Reprise).ogg&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Prima! Just drop the &lt;code&gt;-n&lt;/code&gt; option to have it actually perform the operation on your files.&lt;/p&gt;
&lt;h2&gt;note&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;perl-rename&lt;/code&gt; is not to be confused with &lt;code&gt;rename&lt;/code&gt; from &lt;code&gt;util-linux&lt;/code&gt;, so make sure you have the right one installed.&lt;/p&gt;</content><category term="tips"></category><category term="linux"></category><category term="perl"></category></entry></feed>