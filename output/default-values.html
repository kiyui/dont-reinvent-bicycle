<!DOCTYPE html>
<html lang="en">
  <head>
        <title>
dont reinvent велосипед - Default Title      </title>
      <meta charset="utf-8" />
      <meta name="description" content="when do we use default values?"/>
      <meta name="keywords" content="programming,practice,standards,hacking,musing,improve">
      <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
      <link href="https://fonts.googleapis.com/css?family=IBM+Plex+Mono|IBM+Plex+Serif" rel="stylesheet">
      <link rel="stylesheet" href="https://dontreinventbicycle.com/theme/css/main.css" type="text/css" >
        <link href="https://dontreinventbicycle.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="dont reinvent велосипед Full Atom Feed" />
        <link href="https://dontreinventbicycle.com/feeds/all.rss.xml" type="application/rss+xml" rel="alternate" title="dont reinvent велосипед Full RSS Feed" />
        <link href="https://dontreinventbicycle.com/feeds/atom.xml" type="application/atom+xml" rel="alternate" title="dont reinvent велосипед Atom Feed" />
        <link href="https://dontreinventbicycle.com/feeds/all.xml" type="application/rss+xml" rel="alternate" title="dont reinvent велосипед RSS Feed" />
        <link href="https://dontreinventbicycle.com/feeds/code.atom.xml" type="application/atom+xml" rel="alternate" title="dont reinvent велосипед Categories Atom Feed" />



    <meta name="description" content="when do we use default values?" />

    <meta name="tags" content="programming" />
    <meta name="tags" content="improve" />

  </head>

  <body id="index" class="home">
    <header id="banner" class="body">
      <h1>
        <a href="https://dontreinventbicycle.com/">dont reinvent велосипед <strong></strong></a>
      </h1>
    </header>

    <nav id="menu" class="body">
      <ul>


        <li class="active">
          <a href="https://dontreinventbicycle.com/category/code.html">
            code
          </a>
        </li>
        <li>
          <a href="https://dontreinventbicycle.com/category/personal.html">
            personal
          </a>
        </li>
        <li>
          <a href="https://dontreinventbicycle.com/category/tips.html">
            tips
          </a>
        </li>
      </ul>
    </nav>

    <div class="body">
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="https://dontreinventbicycle.com/default-values.html" rel="bookmark"
         title="Permalink to Default Title">Default Title</a></h2>
 
  </header>
  <footer class="post-info">
    <div>
      published:
      <time class="published" datetime="2019-04-27T17:51:00+08:00">
        Sat 27 April 2019
      </time>
    </div>
    <div>
      modified:
      <time class="modified" datetime="2019-04-27T22:31:00+08:00">
        Sat 27 April 2019
      </time>
    </div>
    <address class="vcard author">
      by           <a class="url fn" href="https://dontreinventbicycle.com/author/timur-kiyui.html">Timur Kiyui</a>
    </address>
    <div class="category">
        category: <a href="https://dontreinventbicycle.com/category/code.html">code</a>
    </div>
    <div class="tags">
        tags:
            <a href="https://dontreinventbicycle.com/tag/programming.html">programming</a>
            <a href="https://dontreinventbicycle.com/tag/improve.html">improve</a>
    </div>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <p>The use of default values, also known as optional parameters is a controversial topic in programming. Languages like Go even go so far to outright disallow the possibility of using optional parameters or method overloading, emphasising simplicity instead. But what exactly are optional parameters used for?</p>
<p>The Wikipedia page for <a href="https://en.wikipedia.org/wiki/C_Sharp_4.0#Optional_parameters_and_named_arguments">C# version 4.0</a> highlights many advantages of the introduction of optional parameters, on top of it being an alternative to operator overloading. Without optional parameters, the following simple class constructor;-</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Cuboid</span>
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">a</span> <span class="p">:</span> <span class="nb">Int32</span><span class="p">,</span> <span class="n">b</span> <span class="p">:</span> <span class="nb">Int32</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span> <span class="p">:</span> <span class="nb">Int32</span> <span class="o">=</span> <span class="n">b</span><span class="p">)</span>
    <span class="vi">@width</span> <span class="o">=</span> <span class="n">a</span>
    <span class="vi">@height</span> <span class="o">=</span> <span class="n">b</span>
    <span class="vi">@length</span> <span class="o">=</span> <span class="n">c</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">volume</span>
    <span class="vi">@width</span> <span class="o">*</span> <span class="vi">@height</span> <span class="o">*</span> <span class="vi">@length</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">cube</span> <span class="o">=</span> <span class="n">Cuboid</span><span class="o">.</span><span class="n">new</span> <span class="mi">5</span>
<span class="n">cube</span><span class="o">.</span><span class="n">volume</span> <span class="c1">#=&gt; 125</span>

<span class="n">cuboid</span> <span class="o">=</span> <span class="n">Cuboid</span><span class="o">.</span><span class="n">new</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span>
<span class="n">cuboid</span><span class="o">.</span><span class="n">volume</span> <span class="c1">#=&gt; 200</span>

<span class="n">long_long_man</span> <span class="o">=</span> <span class="n">Cuboid</span><span class="o">.</span><span class="n">new</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">100</span>
<span class="n">long_long_man</span><span class="o">.</span><span class="n">volume</span> <span class="c1">#=&gt; 1200</span>
</code></pre></div>


<p>would be a lot more verbose, include unnecessary duplication, and have to be written for every possible variation!</p>
<div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">Cuboid</span>  
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">a</span> <span class="p">:</span> <span class="nb">Int32</span><span class="p">)</span>
    <span class="vi">@width</span> <span class="o">=</span> <span class="n">a</span>
    <span class="vi">@height</span> <span class="o">=</span> <span class="n">a</span>
    <span class="vi">@length</span> <span class="o">=</span> <span class="n">a</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">a</span> <span class="p">:</span> <span class="nb">Int32</span><span class="p">,</span> <span class="n">b</span> <span class="p">:</span> <span class="nb">Int32</span><span class="p">)</span>
    <span class="vi">@width</span> <span class="o">=</span> <span class="n">a</span>
    <span class="vi">@height</span> <span class="o">=</span> <span class="n">b</span>
    <span class="vi">@length</span> <span class="o">=</span> <span class="n">b</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">a</span> <span class="p">:</span> <span class="nb">Int32</span><span class="p">,</span> <span class="n">b</span> <span class="p">:</span> <span class="nb">Int32</span><span class="p">,</span> <span class="n">c</span> <span class="p">:</span> <span class="nb">Int32</span><span class="p">)</span>
    <span class="vi">@width</span> <span class="o">=</span> <span class="n">a</span>
    <span class="vi">@height</span> <span class="o">=</span> <span class="n">b</span>
    <span class="vi">@length</span> <span class="o">=</span> <span class="n">c</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>


<p>Additionally, could you imagine having to define every key-value mapping in configuration files each and every time you set something up?</p>
<h2>so, what's the problem?</h2>
<p>One of the main arguments against the use of optional parameters is that it leads to the production of inconsistent APIs. This is one such example:</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span> <span class="nx">rotateMatrix</span> <span class="p">(</span><span class="nx">matrix</span><span class="p">,</span> <span class="nx">angle</span> <span class="o">=</span> <span class="mi">90</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...rotation code</span>
  <span class="k">return</span> <span class="nx">rotatedMatrix</span>
<span class="p">}</span>

<span class="nx">itemOne</span><span class="p">.</span><span class="nx">matrix</span> <span class="o">=</span> <span class="nx">rotateMatrix</span><span class="p">(</span><span class="nx">itemOne</span><span class="p">.</span><span class="nx">matrix</span><span class="p">)</span>       <span class="c1">// What is the angle of the rotation?</span>
<span class="nx">itemTwo</span><span class="p">.</span><span class="nx">matrix</span> <span class="o">=</span> <span class="nx">rotateMatrix</span><span class="p">(</span><span class="nx">itemTwo</span><span class="p">.</span><span class="nx">matrix</span><span class="p">,</span> <span class="mi">180</span><span class="p">)</span>  <span class="c1">// Here, we know immediately</span>
</code></pre></div>


<p>The above function doesn't immediately make it clear what the resulting value of the function will be since it makes a value that should be required optional. Another such argument is that it allows for the introduction of flag-oriented programming. While that is a whole other can of hydras, the following is a classic example of flag-oriented programming:</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span> <span class="nx">logNames</span> <span class="p">(</span><span class="nx">people</span><span class="p">,</span> <span class="nx">logAges</span> <span class="o">=</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">people</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">person</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">output</span> <span class="o">=</span> <span class="sb">`There is a person named </span><span class="si">${</span><span class="nx">person</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span><span class="sb">`</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">logAges</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">output</span> <span class="o">+=</span> <span class="sb">` aged </span><span class="si">${</span><span class="nx">person</span><span class="p">.</span><span class="nx">age</span><span class="si">}</span><span class="sb"> years old`</span>
    <span class="p">}</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">output</span><span class="p">)</span>
  <span class="p">})</span>
<span class="p">}</span>
</code></pre></div>


<p>To add insult to injury, it would seem that the implementation of optional arguments isn't even consistent from one language to another! Consider how Python handles optional parameter default values:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span>

<span class="k">def</span> <span class="nf">with_random</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="p">[]):</span>
    <span class="n">random_value</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">seed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">random_value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">seed</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">with_random</span><span class="p">([</span><span class="mi">23</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span> <span class="c1"># [23, 44, 15, 16]  one value is appended to the array</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">with_random</span><span class="p">()</span>             <span class="c1"># [79]              as expected, an array with length 1</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">with_random</span><span class="p">()</span>             <span class="c1"># [79, 55]          wait what?? ah, python</span>
</code></pre></div>


<p>The following more or less exact same code in JavaScript behaves quite differently!</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span> <span class="nx">withRandom</span><span class="p">(</span><span class="nx">seed</span><span class="o">=</span><span class="p">[])</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">randomValue</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
  <span class="nx">seed</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">randomValue</span><span class="p">)</span>
  <span class="k">return</span> <span class="nx">seed</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">a</span> <span class="o">=</span> <span class="nx">withRandom</span><span class="p">([</span><span class="mi">23</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>  <span class="c1">// [23, 44, 15, 16]</span>
<span class="kd">let</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">withRandom</span><span class="p">()</span>              <span class="c1">// [79]</span>
<span class="kd">let</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">withRandom</span><span class="p">()</span>              <span class="c1">// [55]</span>
</code></pre></div>


<p>Quick! Grab your pitchforks and put an end to the evil that is default values!</p>
<h2>no, your opinion is wrong</h2>
<p>Again, the issue here isn't that defaults are a horrible language feature, but that it is often misused. In the case of the <code>rotateMatrix</code> example, the solution would be to simply to make the angle argument required:</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span> <span class="nx">rotateMatrix</span> <span class="p">(</span><span class="nx">matrix</span><span class="p">,</span> <span class="nx">angle</span><span class="p">)</span> <span class="p">{</span>
  <span class="c1">// ...rotation code</span>
  <span class="k">return</span> <span class="nx">rotatedMatrix</span>
<span class="p">}</span>
</code></pre></div>


<p>In fact, if you do find yourself using the value <code>90</code> as the <code>angle</code> argument more often than not, consider using method-overloading or proxying the function:</p>
<div class="highlight"><pre><span></span><code><span class="kd">function</span> <span class="nx">rotateMatrix90</span> <span class="p">(</span><span class="nx">matrix</span><span class="p">,</span> <span class="nx">angle</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">rotateMatrix</span><span class="p">(</span><span class="nx">matrix</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>


<p>If you still aren't sure <a href="/identifying-hacks.html">how to identify hacky use of optional parameters</a>, here are a few good design principles:</p>
<ul>
<li>do not ever make core parameters optional</li>
<li>do not design functions with optional parameters in mind, but make them optional over time</li>
<li>the optional argument should not be used as a conditional for any control-flow logic</li>
</ul>
<p>I hope this helps, and that you enjoy not having to define every single option in your editor configuration file every time.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># In a world where we don&#39;t already have to do this, I alias l to ls</span>
<span class="nv">LS_COLORS</span><span class="o">=</span><span class="s2">&quot;...&quot;</span> /usr/bin/ls .
</code></pre></div>


<p>This article was powered by the procrastination of setting up a Raspberry Pi.</p>
  </div><!-- /.entry-content -->
</section>
    </div>

    <footer id="contentinfo" class="body">
      <div>
        <h4 class="title">social:</h4>
        <ul class="links">
            <li><a href="https://dontreinventbicycle.com/feeds/atom.xml" rel="alternate">atom feed</a></li>
            <li><a href="https://dontreinventbicycle.com/feeds/all.xml" rel="alternate">rss feed</a></li>
            <li><a href="https://github.com/kiyui">GitHub</a></li>
            <li><a href="https://queer.chat/@dafne">Mastodon</a></li>
            <li><a href="https://www.linkedin.com/in/dafnelately/">LinkedIn</a></li>
        </ul>
      </div>
      <div>
        <h4 class="title">projects:</h4>
        <ul class="links">
          <li><a href="https://registry.jsonresume.org/kiyui">Resume</a></li>
          <li><a href="https://extensions.gnome.org/accounts/profile/TimurKiyivinski">GNOME Extensions</a></li>
        </ul>
      </div>
      <address id="about" class="vcard body">
        Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
        which takes great advantage of <a href="http://python.org">Python</a>.
      </address>
    </footer>
  </body>
</html>